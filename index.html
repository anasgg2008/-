<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Anas Store</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: linear-gradient(135deg, #1e1e1e, #2c2c2c);
        color: #fff;
        margin: 0;
        padding: 0;
    }
    header {
        background-color: #111;
        padding: 15px;
        text-align: center;
        font-size: 1.8em;
        font-weight: bold;
        color: #00ffea;
        letter-spacing: 2px;
    }
    main {
        display: flex;
        justify-content: center;
        align-items: flex-start;
        padding: 30px;
        gap: 40px;
        flex-wrap: wrap;
    }
    .box {
        background: #222;
        border-radius: 15px;
        padding: 20px;
        min-width: 300px;
        flex: 1 1 300px;
        box-shadow: 0 0 15px rgba(0,255,234,0.5);
    }
    .box h2 {
        color: #00ffea;
        text-align: center;
    }
    label {
        display: block;
        margin: 10px 0 5px;
        font-weight: bold;
    }
    select, input {
        width: 100%;
        padding: 10px;
        border-radius: 10px;
        border: none;
        margin-bottom: 15px;
        font-size: 1em;
    }
    input[type="number"] {
        -moz-appearance: textfield;
    }
    input::-webkit-outer-spin-button,
    input::-webkit-inner-spin-button {
        -webkit-appearance: none;
        margin: 0;
    }
    button {
        width: 100%;
        padding: 12px;
        font-size: 1.1em;
        border: none;
        border-radius: 12px;
        margin-top: 10px;
        cursor: pointer;
        transition: 0.3s;
    }
    .sell-btn {
        background: #ff0054;
        color: #fff;
        box-shadow: 0 0 10px #ff0054;
    }
    .sell-btn:hover {
        background: #ff3380;
    }
    .summary {
        margin-top: 20px;
        font-size: 1.1em;
        text-align: center;
        line-height: 1.6em;
        background: #111;
        padding: 15px;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0,255,234,0.5);
    }
    nav {
        position: fixed;
        top: 15px;
        right: 20px;
        background: #111;
        padding: 10px;
        border-radius: 12px;
        box-shadow: 0 0 10px rgba(0,255,234,0.5);
    }
    nav select {
        background: #111;
        color: #00ffea;
        border: none;
        padding: 8px;
        border-radius: 8px;
        font-weight: bold;
        cursor: pointer;
    }
</style>
</head>
<body>
<header>Anas Store</header>

<nav>
<select id="navOptions">
    <option value="">☰ الخيارات</option>
    <option value="stocks.html">المخزون</option>
    <option value="sales.html">المبيعات</option>
</select>
</nav>

<main>
    <div class="box">
        <h2>بيع منتج</h2>
        <label for="product">اختر المنتج:</label>
        <select id="product">
            <option value="">-- اختر منتج --</option>
        </select>
        <label for="quantity">الكمية المباعة:</label>
        <input type="number" id="quantity" min="1" placeholder="أدخل عدد القطع">
        <button class="sell-btn" id="sellBtn">بيع</button>
        <div class="summary" id="summary">
            <p>إجمالي المبيعات: 0</p>
            <p>الربح الكلي: 0</p>
        </div>
    </div>
</main>

<script>
    // عناصر DOM
    const productSelect = document.getElementById('product');
    const quantityInput = document.getElementById('quantity');
    const sellBtn = document.getElementById('sellBtn');
    const summaryDiv = document.getElementById('summary');
    const navOptions = document.getElementById('navOptions');

    // تخزين بيانات المخزون (ستُملأ من stocks.html لاحقًا)
    let products = JSON.parse(localStorage.getItem('products')) || [];
    let salesData = JSON.parse(localStorage.getItem('salesData')) || [];

    // تحديث قائمة المنتجات
    function updateProductList() {
        productSelect.innerHTML = '<option value="">-- اختر منتج --</option>';
        products.forEach(p => {
            productSelect.innerHTML += `<option value="${p.name}">${p.name} (المتبقي: ${p.stock})</option>`;
        });
    }

    // حساب الملخص
    function updateSummary() {
        let totalSales = 0;
        let totalProfit = 0;
        salesData.forEach(sale => {
            totalSales += sale.totalPrice;
            totalProfit += sale.profit;
        });
        summaryDiv.innerHTML = `<p>إجمالي المبيعات: ${totalSales}</p><p>الربح الكلي: ${totalProfit}</p>`;
    }

    // بيع المنتج
    sellBtn.addEventListener('click', () => {
        const productName = productSelect.value;
        const quantity = parseInt(quantityInput.value);
        if (!productName || isNaN(quantity) || quantity <= 0) {
            alert('اختر المنتج وأدخل كمية صحيحة');
            return;
        }

        const product = products.find(p => p.name === productName);
        if (!product) {
            alert('المنتج غير موجود بالمخزون');
            return;
        }
        if (quantity > product.stock) {
            alert('الكمية المطلوبة أكبر من المخزون');
            return;
        }

        const totalPrice = product.salePrice * quantity;
        const profit = (product.salePrice - product.costPrice) * quantity;

        // تحديث المخزون
        product.stock -= quantity;
        localStorage.setItem('products', JSON.stringify(products));

        // تسجيل البيع
        salesData.push({
            name: productName,
            quantity: quantity,
            totalPrice: totalPrice,
            profit: profit,
            date: new Date().toLocaleDateString()
        });
        localStorage.setItem('salesData', JSON.stringify(salesData));

        quantityInput.value = '';
        updateProductList();
        updateSummary();
    });

    // تحديث قائمة التنقل
    navOptions.addEventListener('change', () => {
        if (navOptions.value) {
            window.location.href = navOptions.value;
        }
    });

    // تهيئة الصفحة
    updateProductList();
    updateSummary();
</script>
</body>
</html>
